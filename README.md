# Simple Load Balancer

Go μ–Έμ–΄λ΅ μ‘μ„±λ κ°„λ‹¨ν• HTTP λ΅λ“ λ°Έλ°μ„(Load Balancer)μ…λ‹λ‹¤.  
μ—¬λ¬ λ°±μ—”λ“ μ„λ²„λ΅ νΈλν”½μ„ λ¶„μ‚°μ‹ν‚¤λ©°(Round-Robin), μ£ΌκΈ°μ μΈ ν—¬μ¤ μ²΄ν¬(Health Check)λ¥Ό ν†µν•΄ κ±΄κ°•ν• μ„λ²„λ΅λ§ μ”μ²­μ„ μ „λ‹¬ν•©λ‹λ‹¤.

## β¨ μ£Όμ” κΈ°λ¥

- **λ΅λ“ λ°Έλ°μ‹±**: λ“¤μ–΄μ¤λ” HTTP μ”μ²­μ„ μ„¤μ •λ λ°±μ—”λ“ μ„λ²„λ“¤λ΅ μμ°¨μ μΌλ΅ λ¶„μ‚°ν•©λ‹λ‹¤ (Round-Robin).
- **ν—¬μ¤ μ²΄ν¬ (Health Check)**:
  - μ£ΌκΈ°μ μΌλ΅(κΈ°λ³Έ 5μ΄) λ°±μ—”λ“ μ„λ²„μ μƒνƒλ¥Ό ν™•μΈν•©λ‹λ‹¤.
  - μ‘λ‹µν•μ§€ μ•λ” μ„λ²„λ” λ΅λ“ λ°Έλ°μ‹± λ€μƒμ—μ„ μλ™μΌλ΅ μ μ™Έλ©λ‹λ‹¤.
  - μ„λ²„κ°€ λ‹¤μ‹ λ³µκµ¬λλ©΄ μλ™μΌλ΅ λ€μƒμ— ν¬ν•¨λ©λ‹λ‹¤.
- **μ„¤μ • νμΌ μ§€μ›**: `config.yaml` νμΌμ„ ν†µν•΄ ν¬νΈ, μ „λµ, λ°±μ—”λ“ μ„λ²„ λ©λ΅μ„ μ‰½κ² λ³€κ²½ν•  μ μμµλ‹λ‹¤.
- **ν…μ¤νΈ ν™κ²½ μ κ³µ**: λ΅λ“ λ°Έλ°μ‹± λ™μ‘μ„ μ‰½κ² ν™•μΈν•  μ μλ” λ”λ―Έ μ„λ²„ μ¤ν¬λ¦½νΈ(`dummy_servers.go`)λ¥Ό ν¬ν•¨ν•κ³  μμµλ‹λ‹¤.

## π€ μ‹μ‘ν•κΈ° (Getting Started)

### 1. μ „μ  μ΅°κ±΄ (Prerequisites)
- [Go](https://go.dev/)κ°€ μ„¤μΉλμ–΄ μμ–΄μ•Ό ν•©λ‹λ‹¤.

### 2. μ„¤μΉ λ° μ‹¤ν–‰

#### 1) λ”λ―Έ μ„λ²„ μ‹¤ν–‰ (Optional)
λ΅μ»¬μ—μ„ ν…μ¤νΈν•κΈ° μ„ν•΄ 3κ°μ λ°±μ—”λ“ μ„λ²„(Port: 9001, 9002, 9003)λ¥Ό μ‹¤ν–‰ν•©λ‹λ‹¤.
μƒ ν„°λ―Έλ„μ„ μ—΄κ³  λ‹¤μ λ…λ Ήμ–΄λ¥Ό μ‹¤ν–‰ν•μ„Έμ”.

```bash
go run dummy_servers.go
```
> **μ°Έκ³ **: ν„μ¬ `dummy_servers.go` μ½”λ“ μƒμ—μ„λ” 9002λ² ν¬νΈ μ„λ²„ μ‹¤ν–‰ μ½”λ“κ°€ μ£Όμ„ μ²λ¦¬λμ–΄ μμµλ‹λ‹¤. ν•„μ” μ‹ μ£Όμ„μ„ ν•΄μ ν•μ—¬ ν…μ¤νΈν•  μ μμµλ‹λ‹¤.

#### 2) λ΅λ“ λ°Έλ°μ„ μ‹¤ν–‰
λ‹¤λ¥Έ ν„°λ―Έλ„μ—μ„ λ΅λ“ λ°Έλ°μ„λ¥Ό μ‹¤ν–‰ν•©λ‹λ‹¤. κΈ°λ³Έμ μΌλ΅ 8000λ² ν¬νΈμ—μ„ μ‹¤ν–‰λ©λ‹λ‹¤.

```bash
go run cmd/main.go
```

### 3. λ™μ‘ ν™•μΈ
λΈλΌμ°μ €λ‚ `curl` λ…λ Ήμ–΄λ¥Ό ν†µν•΄ λ΅λ“ λ°Έλ°μ„μ— μ”μ²­μ„ λ³΄λ‚΄ λ™μ‘μ„ ν™•μΈν•©λ‹λ‹¤.

```bash
curl http://localhost:8000
```
μ—¬λ¬ λ² μ”μ²­μ„ λ³΄λ‚΄λ©΄, μ‹¤ν–‰ μ¤‘μΈ λ°±μ—”λ“ μ„λ²„λ“¤λ΅ μ”μ²­μ΄ λ²κ°μ•„κ°€λ©° μ „λ‹¬λλ” κ²ƒμ„ ν™•μΈν•  μ μμµλ‹λ‹¤.

## β™οΈ μ„¤μ • (Configuration)

`config.yaml` νμΌμ—μ„ μ„¤μ •μ„ λ³€κ²½ν•  μ μμµλ‹λ‹¤.

```yaml
# λ΅λ“ λ°Έλ°μ„κ°€ μ‹¤ν–‰λ  ν¬νΈ
port: ":8000"

# λ΅λ“ λ°Έλ°μ‹± μ „λµ (ν„μ¬ Round-Robin λ™μ‘)
strategy: "round-robin"

# νΈλν”½μ„ λ¶„μ‚°ν•  λ°±μ—”λ“ μ„λ²„ λ©λ΅
backends:
  - "http://localhost:9001"
  - "http://localhost:9002"
  - "http://localhost:9003"
```

## π“‚ ν”„λ΅μ νΈ κµ¬μ΅°

```
simple-lb/
β”β”€β”€ cmd/
β”‚   β””β”€β”€ main.go           # ν”„λ΅κ·Έλ¨ μ—”νΈλ¦¬ ν¬μΈνΈ
β”β”€β”€ config/
β”‚   β””β”€β”€ config.go         # μ„¤μ • νμΌ λ΅λ“ λ° νμ‹± λ΅μ§
β”β”€β”€ proxy/
β”‚   β””β”€β”€ lb.go             # λ΅λ“ λ°Έλ°μ„ ν•µμ‹¬ λ΅μ§ (ReverseProxy, HealthCheck)
β”β”€β”€ config.yaml           # μ„¤μ • νμΌ
β”β”€β”€ dummy_servers.go      # ν…μ¤νΈμ© λ”λ―Έ λ°±μ—”λ“ μ„λ²„
β””β”€β”€ README.md             # ν”„λ΅μ νΈ μ„¤λ…μ„
```
